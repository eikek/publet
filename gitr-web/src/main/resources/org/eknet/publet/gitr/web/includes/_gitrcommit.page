---
title: Gitr Web

--- name:head pipeline:jade
link(rel="stylesheet" href="gitr.css")
script(src="gitr-browser.js" type="text/javascript")
:javascript
  $(function() {
    $('#searchRev').on('click', function(e) {
      var rev = $('#revnames').val();
      if (rev) {
        var repo = getURLParameter("r");
        window.location=window.location.origin+ window.location.pathname+"?r="+repo+"&h="+rev+"&do=commit";
      }
      return false;
    });
  });
--- name:content pipeline:jade
- import org.eknet.publet.gitr._
- import java.text.DateFormat
- import org.eclipse.jgit.revwalk.RevCommit
-@ val commit: RevCommit = null
-@ val parent: RevCommit = null
-@ val changedFiles: List[PathModel] = List()
- val dateFormat = DateFormat.getDateTimeInstance(DateFormat.LONG, DateFormat.LONG, PubletWebContext.getLocale)
-
  def stripLongPath(p: String): (String, String) = {
    val len = p.length
    if (len > 110) {
      ("..." + p.substring(len-110), p.substring(0, len-110)+"...")
    } else {
      (p, "")
    }
  }
=include("_gitrpagehead.jade")
table.plain
  tbody
    tr
      td
        span.monospace
          b authored
      td
        span.monospace
          =dateFormat.format(commit.getAuthorIdent.getWhen)
          | by
          =commit.getAuthorIdent.getName
    tr
      td
        span.monospace
          b committed
      td
        span.monospace
          =dateFormat.format(commit.getCommitterIdent.getWhen)
          | by
          =commit.getCommitterIdent.getName

    tr
      td
        span.monospace
          b sha1
      td
        span.monospace
          =commit.getId.getName
    -if (parent != null) {
      tr
        td
          span.monospace
            b parent-sha1
        td
          span.monospace
            =parent.getId.getName
    - }
    tr
      td(colspan=2)
        hr/
        span.monospace
          =commit.getShortMessage
br/
h3.commit-group-head
  i.icon-file
  | Changed files
  =" ("+ changedFiles.size +")"
table.table.table-condensed.table-striped
  tbody
    - for (pm <- changedFiles) {
      tr
        td.changeType
          div(class={pm.changeType.get.name} title={pm.changeType.get.name})
        td.path
          - val t = stripLongPath(pm.path)
          span(title={ t._2 })
            =t._1
        td.actions
          a(href="#" title="diff")
            i.icon-plus
    - }